---
description: "Context Engineering增强的任务生成命令 - 智能任务分解和依赖优化"
scripts:
  sh: scripts/bash/get-feature-info.sh --json "{ARGS}"
  ps: scripts/powershell/get-feature-info.ps1 -Json "{ARGS}"
---

# Context Engineering Enhanced /tasks Command

**上下文工程模式**: 智能任务分解和验证驱动的执行规划
**深度优化**: 依赖分析、风险预测、资源优化

## Context Engineering Enhanced 执行流程

### 阶段1: 上下文加载和智能分析
```
1.1 增强脚本执行和信息收集
   → 从仓库根目录运行脚本 `{SCRIPT}`
   → 解析JSON输出获取功能信息:
     * FEATURE_DIR: 功能目录路径
     * AVAILABLE_DOCS: 可用文档列表
   → **重要**: 只能运行此脚本一次
   → 所有文件路径必须是绝对路径

1.2 智能文档分析和上下文构建
   → 深度分析所有可用的设计文档:
     * spec.md: 功能需求和验收标准
     * plan.md: 实施策略和技术决策
     * data-model.md: 数据结构和关系
     * contracts/: API规范和接口定义
     * research.md: 技术研究和最佳实践
     * quickstart.md: 开发环境和工具
   → 构建功能的完整上下文图谱
   → 识别关键的实施约束和依赖

1.3 代码库智能扫描
   → 分析现有的项目结构和模块组织
   → 识别可复用的组件和工具函数
   → 评估现有的测试框架和CI/CD流程
   → 检测代码质量标准和开发约定
```

### 阶段2: 智能任务分析和分解
```
2.1 需求驱动的任务识别
   → 基于用户故事和验收标准生成核心任务
   → 从技术约束中推导设置和配置任务
   → 基于API合约生成接口实现任务
   → 从数据模型生成数据层任务

2.2 上下文感知的任务分类
   → 设置任务: 环境配置、依赖安装、数据库迁移
   → 核心任务: 业务逻辑实现、API开发、数据处理
   → 集成任务: 系统集成、第三方服务、中间件
   → 测试任务: 单元测试、集成测试、端到端测试
   → 完善任务: 文档、监控、性能优化、安全加固

2.3 智能复杂度评估
   → 基于代码库分析评估实施复杂度
   → 考虑团队技能和经验水平
   → 评估外部依赖和集成复杂度
   → 预测潜在的技术风险和挑战
```

### 阶段3: 上下文驱动的任务生成
```
3.1 加载增强任务模板
   → 加载 `templates/context-enhanced-tasks-template.md`
   → 理解智能任务生成的要求和规则
   → 准备上下文丰富的任务生成策略

3.2 智能任务内容生成
   → 为每个任务生成详细的实施指导:
     * 明确的目标和验收标准
     * 具体的实施步骤和技术要点
     * 相关的代码示例和最佳实践
     * 潜在的问题和解决方案
     * 测试策略和验证方法

3.3 上下文丰富的任务描述
   → 集成项目特定的技术栈和工具
   → 引用相关的文档和代码示例
   → 包含性能和安全考虑
   → 提供调试和故障排除指导
```

### 阶段4: 智能依赖分析和排序
```
4.1 多维依赖关系分析
   → 技术依赖: 代码模块、数据库、外部服务
   → 逻辑依赖: 业务流程、数据流、用户体验
   → 资源依赖: 开发技能、工具、环境配置
   → 时间依赖: 关键路径、并行机会、里程碑

4.2 智能排序算法
   → 基于依赖关系的拓扑排序
   → 考虑风险和复杂度的优先级调整
   → 优化并行执行机会
   → 平衡团队工作负载

4.3 验证驱动的任务优化
   → 确保每个任务都有明确的验证标准
   → 优化反馈循环和迭代机会
   → 集成持续集成和自动化测试
   → 提供渐进式交付的里程碑
```

### 阶段5: 质量保证和智能优化
```
5.1 任务完整性验证
   → 检查所有功能需求是否被任务覆盖
   → 验证任务间的逻辑一致性
   → 确认验收标准的可测试性
   → 评估任务粒度的合理性

5.2 智能优化建议
   → 识别可合并或拆分的任务
   → 建议并行执行的机会
   → 优化关键路径和瓶颈
   → 提供资源分配建议

5.3 风险预警和缓解
   → 识别高风险任务和依赖
   → 提供具体的风险缓解策略
   → 建议监控和预警机制
   → 制定应急和回滚计划
```

### 阶段6: 增强输出和执行准备
```
6.1 生成智能任务文件
   → 写入 `tasks.md` 到功能目录
   → 包含所有上下文丰富的任务详情
   → 集成智能依赖排序和优先级
   → 提供执行指导和验证标准

6.2 全面完成报告
   → 报告生成的任务数量和类型分布
   → 总结关键的依赖关系和风险点
   → 提供执行时间估算和资源需求
   → 建议执行策略和里程碑规划

6.3 智能执行建议
   → 推荐最优的执行顺序和并行策略
   → 提供团队协作和沟通建议
   → 建议工具和自动化机会
   → 预测常见问题和解决方案
```

## Context Engineering 增强特性

### 智能任务生成
```yaml
上下文感知生成:
  - 基于项目特征的任务模板选择
  - 自动化的技术栈适配
  - 智能的复杂度评估和调整
  - 个性化的团队技能匹配

验证驱动设计:
  - 每个任务都有明确的验证标准
  - 集成自动化测试和CI/CD
  - 提供渐进式验证和反馈
  - 支持持续改进和优化

质量保证机制:
  - 多层次的任务验证
  - 自动化的一致性检查
  - 智能的优化建议
  - 持续的质量监控
```

### 智能依赖管理
```yaml
多维依赖分析:
  - 技术依赖的深度分析
  - 业务逻辑的依赖映射
  - 资源和技能的依赖评估
  - 时间和里程碑的依赖规划

智能排序优化:
  - 基于依赖的拓扑排序
  - 风险和复杂度的权重调整
  - 并行执行机会的识别
  - 关键路径的优化

动态调整能力:
  - 基于执行反馈的动态调整
  - 风险变化的实时响应
  - 资源变化的自适应
  - 优先级的智能重排
```

### 自适应执行支持
```yaml
复杂度自适应:
  - 简单功能: 快速任务，专注核心实现
  - 中等复杂: 平衡任务，考虑质量和效率
  - 高复杂度: 细粒度任务，强化验证和风险控制
  - 关键系统: 极致细分，多重验证和监控

团队能力匹配:
  - 新手团队: 详细指导和最佳实践
  - 经验团队: 高效任务和优化技巧
  - 专家团队: 创新任务和前沿技术
  - 混合团队: 分层任务和知识传递

项目阶段适配:
  - 新项目: 强调基础设施和架构
  - 扩展项目: 专注集成和兼容性
  - 重构项目: 强调迁移和风险控制
  - 维护项目: 专注稳定性和向后兼容
```

## 智能任务分类系统

### 设置任务 (Setup Tasks)
```yaml
环境配置:
  - 开发环境搭建和配置
  - 依赖包安装和版本管理
  - 数据库初始化和迁移
  - 配置文件和环境变量

基础设施:
  - CI/CD流程配置
  - 监控和日志系统
  - 安全和权限配置
  - 性能监控和告警
```

### 核心任务 (Core Tasks)
```yaml
业务逻辑:
  - 核心功能实现
  - 数据处理和验证
  - 业务规则和约束
  - 用户交互和体验

API开发:
  - 接口设计和实现
  - 数据序列化和验证
  - 错误处理和响应
  - 版本控制和兼容性
```

### 集成任务 (Integration Tasks)
```yaml
系统集成:
  - 内部服务集成
  - 第三方API集成
  - 数据库和缓存集成
  - 消息队列和事件处理

中间件:
  - 认证和授权
  - 限流和熔断
  - 缓存和优化
  - 日志和监控
```

### 测试任务 (Testing Tasks)
```yaml
自动化测试:
  - 单元测试和覆盖率
  - 集成测试和API测试
  - 端到端测试和用户场景
  - 性能测试和压力测试

质量保证:
  - 代码审查和静态分析
  - 安全扫描和漏洞检测
  - 兼容性测试和回归测试
  - 用户验收测试
```

### 完善任务 (Polish Tasks)
```yaml
文档和指南:
  - API文档和使用指南
  - 开发文档和架构说明
  - 用户手册和FAQ
  - 运维手册和故障排除

优化和加固:
  - 性能优化和调优
  - 安全加固和合规
  - 监控和告警优化
  - 用户体验优化
```

## 使用示例

### 基础使用（自动检测复杂度）
```bash
/tasks
```

### 指定任务生成策略
```bash
/tasks [DETAILED] # 生成详细的任务指导
/tasks [AGILE] # 生成敏捷开发友好的任务
/tasks [PARALLEL] # 优化并行执行机会
```

### 针对特定团队类型
```bash
/tasks [JUNIOR] # 适合新手团队的详细任务
/tasks [SENIOR] # 适合经验团队的高效任务
/tasks [MIXED] # 适合混合团队的分层任务
```

## 输出增强

### 标准输出 + Context Engineering 洞察
```markdown
✅ 智能任务生成完成
📁 任务文件: /path/to/specs/003-user-authentication-system/tasks.md
📊 任务统计:
   • 总任务数: 23个
   • 设置任务: 4个 (环境配置、数据库、依赖)
   • 核心任务: 8个 (认证逻辑、API、数据处理)
   • 集成任务: 5个 (JWT、邮件、缓存)
   • 测试任务: 4个 (单元、集成、安全、性能)
   • 完善任务: 2个 (文档、监控)

🧠 Context Engineering 分析结果:
   • 复杂度分布: 简单(8) | 中等(12) | 复杂(3)
   • 关键路径: 数据库设计 → 核心认证 → API实现 → 测试
   • 并行机会: 前端集成可与后端API并行开发
   • 风险任务: 双因素认证集成(复杂度高，外部依赖)

⚡ 智能依赖优化:
   • 优化后的执行顺序可节省20%的开发时间
   • 识别出3个可并行执行的任务组
   • 关键路径优化：减少2个阻塞依赖
   • 建议的里程碑: 基础认证(1周) → 双因素(1周) → 完善(0.5周)

🎯 执行建议:
   • 优先级: 先完成设置任务，建立开发基础
   • 团队分工: 后端(认证逻辑) + 前端(UI集成) 并行
   • 风险缓解: 双因素认证建议先做技术验证
   • 质量门控: 每个里程碑都有对应的测试和验收标准

📋 下一步行动:
   • 所有任务已按依赖关系排序，可以开始执行
   • 建议先review任务详情，确认技术方案
   • 准备开发环境: 参考第一个设置任务
   • 建议使用 /implement 开始执行第一个任务

⚠️ 关键提醒:
   • 任务#15(双因素认证)需要额外的技术研究
   • 任务#8(密码重置)涉及邮件服务配置
   • 任务#20(性能测试)需要生产环境数据
```

---

**注意**: 此增强版本在保持与原始 `/tasks` 命令完全兼容的同时，提供了智能的任务分解、优化的依赖排序和全面的执行指导。所有任务都经过上下文验证和风险评估。